---
date: 2022-06-24~~16:15:00
citation: OneNote-Вычислительная_Математика-Лекция_№10
name: "Численное Дифференцирование"
---
# MOC:
- [[Численное Дифференцирование#Одномерный случай|Одномерный случай]]:
	- [[Численное Дифференцирование#Вывод постановки задачи ОС|Вывод постановки задачи]];
	- [[Численное Дифференцирование#Постановка задачи ОС|Постановка задачи]];
	- [[Численное Дифференцирование#Методы решения задачи ОС|Методы решения задачи]].
- [[Численное Дифференцирование#Двумерный случай|Двумерный случай]]:
	- [[Численное Дифференцирование#Вывод постановки задачи ДС|Вывод постановки задачи]];
	- [[Численное Дифференцирование#Постановка задачи ДС|Постановка задачи]];
	- [[Численное Дифференцирование#Методы решения задачи ДС|Методы решения задачи]].

## Одномерный случай:
### Вывод постановки задачи (ОС):
Пусть требуется решить [[Дифференциальное Уравнение (ДУ)|ДУ]] $\varphi(x) = ?$ при переменной $x\in [0,l]$.
Например, [[Дифференциальное Уравнение (ДУ)|ДУ]] вида: $3u''(x) + 5u'(x) - x^2u(x) + 7 = 0$.
Чаще всего при решении задач о **численном дифференцировании** задаются [[Дифференциальное Уравнение (ДУ)|ДУ]] $2$-[[Дифференциальное Уравнение 2-го Порядка|го порядка]] либо порядка *кратного* $2$-м.
Общий вид [[Дифференциальное Уравнение (ДУ)|ДУ]] $2$-[[Дифференциальное Уравнение 2-го Порядка|го порядка]] в данном случае обозначим как: $$a(x)u''(x) + b(x)u'(x) + c(x)u(x) = F(x)\;\;\;(1)$$
Так как дано [[Дифференциальное Уравнение (ДУ)|дифференциальное уравнение]] $2$[[Дифференциальное Уравнение 2-го Порядка|-го порядка]] то для решения необходимо $2$ дополнительных условия (если порядок [[Дифференциальное Уравнение (ДУ)|ДУ]] больше 2-х то необходимо соответствующее количество дополнительных условий).
Пусть эти условия — значения функции (или их производных) на границах отрезка (*граничные условия*), при этом в зависимости от вида представления этих условий задачу о **численном дифференцировании** можно разделить на три вида:
1) [[Первая Краевая Задача ДУ|Первая краевая задача]], для которой граничные условия: $$u(0) = A, u(l) = B\;\;\;(2)$$
2) [[Вторая Краевая Задача ДУ|Вторая краевая задача]], для которой граничные условия: $$u'(0) = A, u'(l) = B\;\;\;(3)$$
3) [[Третья Краевая Задача ДУ|Третья краевая задача]], для которой граничные условия: $$u(0)u'(0) = A,u(l)u'(l) = B\;\;\;(4)$$
Обозначим [[Точное Решение|точное решение]] [[Дифференциальное Уравнение (ДУ)|ДУ]] $(1)-(2)$ выше в виде: $\varphi(x)$.
Тогда мы получаем постановку задачи в таком виде:
#### Задача численного дифференцирования:
$$x\in[0,l] \rightarrow \Bigg\{\,\begin{array}{rcl}
	a(x)u''(x) + b(x)u'(x) + c(x)u(x) = F(x) \\
	u(0) = A \\
	u(l) = B \\
\end{array}\;\;\;\;\varphi(x) = ?$$
#### Исходные данные:
- Формула $a(x)u''(x) + b(x)u'(x) + c(x)u(x) = F(x)$, где:
	- $a(x),b(x),c(x),F(x)$ - функции от переменной $x$ любого вида.
- Граничные условия:
	- $u(0) = A$ и $u(l) = B$ - для [[Первая Краевая Задача ДУ|первой краевой задачи ДУ]];
	- $u'(0) = A$ и $u'(l) = B$ - для [[Вторая Краевая Задача ДУ|второй краевой задачи ДУ]];
	- $u(0)u'(0) = A$ и $u(l)u'(l) = B$ - для [[Третья Краевая Задача ДУ|третьей краевой задачи ДУ]].

При этом:
- $u(x)$ - непрерывна на отрезке $x\in [0,l]$;
- $u(x)$ - непрерывна дифференцируемая дважды на интервале $x\in (0,l)$.

#### Дополнительные манипуляции
Для удобства на отрезке $x\in [0,l]$ введем [[Равномерная Сетка|равномерную сетку]] с [[Шаг Сетки|шагом]] $h$ и количеством [[Узел Сетки|узлов]]: $N+1$: $$w_h = \{x_i = ih, i=0,...,N,N = \frac{l - 0}{h}\}$$

Тогда [[Приближенное Решение|приближенное решение]] [[Дифференциальное Уравнение (ДУ)|ДУ]] $(1)-(2)$ будет представлено в виде вектора [[Приближенное Решение|приближенных значений]]: $y_h = \{y_0,y_1,...,y_N\}$, где $y_i, i=0,...,N$ - [[Приближенное Решение|приближенные значения]] функции в [[Узел Сетки|узлах]] $x_i$.

В итоге задача **численного дифференцирования** состоит в нахождении неизвестных [[Приближенное Решение|приближенных значений]] $y_1,y_2,...,y_{N-1}$ (так как $y_0$ и $y_N$ нам уже известны из граничных условий).

### Постановка задачи (ОС):
$$x\in[0,l] \rightarrow \Bigg\{\,\begin{array}{rcl}
	a(x)u''(x) + b(x)u'(x) + c(x)u(x) = F(x) \\
	Граничное\;условие\;№1 \\
	Граничное\;условие\;№2 \\
\end{array}\;\;\;\;\varphi(x) = ?$$
При этом отрезок $x\in[0,l]$ представлен в виде [[Равномерная Сетка|равномерной сетки:]] $$w_h = \{x_i = ih, i=0,...,N,N = \frac{l - 0}{h}\}$$
Где:
- $\varphi(x)$ - [[Точное Решение|точная функция]];
- $\varphi'(x) = u'(x)$ - первая производная от точной функции;
- $\varphi''(x) = u''(x)$ - вторая производная от точной функции;
- $a(x),b(x),c(x),F(x)$ - произвольные функции от переменной $x$;
- Граничные условия:
	- $u(0) = A$ и $u(l) = B$ - для [[Первая Краевая Задача ДУ|первой краевой задачи ДУ]];
	- $u'(0) = A$ и $u'(l) = B$ - для [[Вторая Краевая Задача ДУ|второй краевой задачи ДУ]];
	- $u(0)u'(0) = A$ и $u(l)u'(l) = B$ - для [[Третья Краевая Задача ДУ|третьей краевой задачи ДУ]].
- $x\in[0,l]$ - отрезок, внутри которого мы хотим найти вектор [[Приближенное Решение|приближенных значений]] $y$ неизвестной [[Точное Решение|точной функции]] $\varphi(x)$.

#### Изначальные данные:
- [[Дифференциальное Уравнение (ДУ)|ДУ]] с одной переменной вида $a(x)u''(x) + b(x)u'(x) + c(x)u(x) = F(x)$;
- Граничные условия:
	- $u(0) = A$ и $u(l) = B$ - для [[Первая Краевая Задача ДУ|первой краевой задачи ДУ]];
	- $u'(0) = A$ и $u'(l) = B$ - для [[Вторая Краевая Задача ДУ|второй краевой задачи ДУ]];
	- $u(0)u'(0) = A$ и $u(l)u'(l) = B$ - для [[Третья Краевая Задача ДУ|третьей краевой задачи ДУ]].
- Отрезок $x\in[0;l]$.

При этом:
- $u(x)$ - непрерывна на отрезке $x\in [0,l]$;
- $u(x)$ - непрерывна дифференцируемая дважды на интервале $x\in (0,l)$.

#### Неизвестные:
- Точная формула $\varphi(x)$, приближенные значения которой мы пытаемся найти;
- Ещё не заданная [[Равномерная Сетка|равномерная сетка]]: $w_h = \{x_i = x_0 + ih,i=0,...,N, N = \frac{x_N - x_0}{h}\}$ (задаётся с помощью определения изначального количества [[Узел Сетки|узлов сетки]] $N - 1$ или изначального [[Шаг Сетки|шага сетки]] $h$).

### Результат решения:
- Вектор $u_h$ [[Приближенное Решение|приближенных значений]] [[Точное Решение|точной функции]] $\varphi(x)$ с [[Допустимая Числовая Погрешность|точностью]] $\epsilon$.

### Методы решения задачи (ОС):

![[Метод Сеток (Разностный Метод) Решения Задач для ДУ в Одномерном Случае для ОДУ 2-го Порядка с Одной Переменной]]

## Двумерный случай:
### Вывод постановки задачи (ДС):
Пусть нам требуется решить [[Дифференциальное Уравнение (ДУ)|ДУ]] $\varphi(x,y) = ?$ при переменных $x \in [0;a]$ и $y \in [0;b]$, и предложенной формулы вида $$-\Delta u(x,y) + ku(x,y) = f(x,y)$$Где:
- $\Delta u(x,y) = \frac{\delta^2 u}{\delta x^2} + \frac{\delta^2 u}{\delta y^2}$ - [[Оператор Лапласа|оператор Лапласа]];
- $k,f(x,y)$ - заданы в области $\Omega$:
	- Область $\Omega$ можно представить в виде: $$\Omega = \Bigg\{(x,y):\;\;\,\begin{array}{rcl}
	0 < x < a \\
	0 < y < b \\
\end{array}\,\Bigg\}$$
- При этом дана $\Gamma$ граница $\Omega$ в виде: $$\Gamma = \Bigg\{(x,y):\;\;\,\begin{array}{rcl}
	x=0,&0\leq y \leq b \\
	x=a,&0\leq y \leq b \\
	y=0,&0\leq x \leq a \\
	y=b,&0\leq x \leq a \\
\end{array}\,\Bigg\}$$

Например, задача о нахождении [[Приближенное Решение|приближенной]] температуры пластины зная ее температуру (или производную от температуры в зависимости от типа краевой задачи) на границах пластины и [[Дифференциальное Уравнение (ДУ)|ДУ]] выше:
![[Pasted image 20220626145907.png]]

Для удобства введем две [[Равномерная Сетка|равномерные сетки]] по одной на каждую переменную:
- Для переменной $x$: $w_{h_x} = \{x_i = 0 + ih_x, i = 0,...,N_x, h_x = \frac{a - 0}{N_x}\}$Где:
	- $h_x$ - [[Шаг Сетки|шаг]] [[Равномерная Сетка|равномерной сетки]] переменной $x$;
	- $N_x+1$ - количество [[Узел Сетки|узлов]] [[Равномерная Сетка|равномерной сетки]] переменной $x$.
- Для переменной $y$: $w_{h_y} = \{y_j = 0 + jh_y, j = 0,...,N_y, h_y = \frac{b - 0}{N_y}\}$Где:
	- $h_y$ - [[Шаг Сетки|шаг]] [[Равномерная Сетка|равномерной сетки]] переменной $y$;
	- $N_y+1$ - количество [[Узел Сетки|узлов]] [[Равномерная Сетка|равномерной сетки]] переменной $y$.
Из-за чего мы можем представить заданную область $\Omega$ и границу $\Gamma$ в таком виде:
![[Pasted image 20220626153451.png]]
При этом обозначим [[Приближенное Решение|приближенное значение]] и [[Точное Решение|точное значение]] функции на таком разделении с помощью соответствующих обозначений: $u(x_i,y_j) = u_{ij}$ и $\varphi(x_i,y_j) = \varphi_{ij}$.

Чтобы избежать повторяющиеся координаты при таком разделении области $\Omega$, определим граничные условия таким образом: $$\Bigg\{u_{ij} = \varphi_{ij}:\;\;\,\begin{array}{rcl}
	i=1,&j = 0,...,N_{y}-1 \\
	i=N_x,&j = 1,...,N_{y}-1 \\
	j=0,&i = 0,...,N_{x} \\
	j=N_y,&i = 0,...,N_{x} \\
\end{array}\,\Bigg\}$$
Таким образом, мы можем обозначить постановку задачи **численного дифференцирования** для [[Дифференциальное Уравнение 2-го Порядка|ДУ 2-го порядка]] с двумя переменными:

### Постановка задачи (ДС):
Дано [[Дифференциальное Уравнение 2-го Порядка|ДУ 2-го порядка]] с двумя переменными и граничные условия.
Требуется найти вектор [[Приближенное Решение|приближенных значений]] $u_h$ для [[Точное Решение|точной функции]] $\varphi(x,y)$ с [[Допустимая Числовая Погрешность|точностью]] $\epsilon$.
$$
\Bigg\{\,\begin{array}{rcl}
	-\Delta u_{ij} + ku_{ij} = f(x,y) \\
	u_{ij} = \varphi_{ij}:\;\;\,\Bigg\{\begin{array}{rcl}
	i=1,&j = 0,...,N_{y}-1 \\
	i=N_x,&j = 1,...,N_{y}-1 \\
	j=0,&i = 0,...,N_{x} \\
	j=N_y,&i = 0,...,N_{x} \\
\end{array}\Bigg\}
\end{array}\,\Bigg\}
$$
Где:
- $\Delta u(x,y) = \frac{\delta^2 u}{\delta x^2} + \frac{\delta^2 u}{\delta y^2}$ - [[Оператор Лапласа|оператор Лапласа]];
- $k,f(x,y)$ - заданы в области $\Omega$:
	- Область $\Omega$ можно представить в виде: $$\Omega = \Bigg\{(x,y):\;\;\,\begin{array}{rcl}
	0 < x < a \\
	0 < y < b \\
\end{array}\,\Bigg\}$$
- $\Gamma$ - граница заданной области $\Omega$: $$\Gamma = \Bigg\{(x,y):\;\;\,\begin{array}{rcl}
	x=0,&0\leq y \leq b \\
	x=a,&0\leq y \leq b \\
	y=0,&0\leq x \leq a \\
	y=b,&0\leq x \leq a \\
\end{array}\,\Bigg\}$$
При этом заданная область $\Omega$ представлена в виде двух [[Равномерная Сетка|равномерных сеток]] по одной на каждую переменную:
- Для переменной $x$: $w_{h_x} = \{x_i = 0 + ih_x, i = 0,...,N_x, h_x = \frac{a - 0}{N_x}\}$Где:
	- $h_x$ - [[Шаг Сетки|шаг]] [[Равномерная Сетка|равномерной сетки]] переменной $x$;
	- $N_x+1$ - количество [[Узел Сетки|узлов]] [[Равномерная Сетка|равномерной сетки]] переменной $x$.
- Для переменной $y$: $w_{h_y} = \{y_j = 0 + jh_y, j = 0,...,N_y, h_y = \frac{b - 0}{N_y}\}$Где:
	- $h_y$ - [[Шаг Сетки|шаг]] [[Равномерная Сетка|равномерной сетки]] переменной $y$;
	- $N_y+1$ - количество [[Узел Сетки|узлов]] [[Равномерная Сетка|равномерной сетки]] переменной $y$.

#### Искомые данные (ДС):
- Формула [[Дифференциальное Уравнение 2-го Порядка|ДУ 2-го порядка]] с двумя переменными: $-\Delta u_{ij} + ku_{ij} = f(x,y)$;
- Отрезки $x\in [0,a]$ и $y\in[0,b]$ (заданная область $\Omega$);
- Граничные условия выше внутри границы $\Gamma$ (для разных краевых задач разные условия, [[Численное Дифференцирование#Постановка задачи ОС|см для одномерного случая]]);
- Изначальные [[Шаг Сетки|шаги]] [[Равномерная Сетка|равномерных сеток]] $h_x$ и $h_y$ или количество [[Узел Сетки|узлов]] [[Равномерная Сетка|равномерных сеток]] $N_x$ и $N_y$;
- [[Допустимая Числовая Погрешность|Допустимая числовая погрешность]] $\epsilon$.

#### Неизвестные (ДС):
- [[Точное Решение|Точная формула]] $\varphi(x,y)$, [[Приближенное Решение|приближенные значения]] которого в заданной области $\Omega$ мы пытаемся найти.

#### Результат решения (ДС):
- Вектор $u_h$ [[Приближенное Решение|приближенных значений]] [[Точное Решение|точной функции]] $\varphi(x,y)$ с [[Допустимая Числовая Погрешность|точностью]] $\epsilon$.

### Методы решения задачи (ДС):

![[Метод Сеток (Разностный Метод) Решения Задач для ДУ в Двумерном Случая для ДУ 2-го Порядка с Двумя Переменными]]
