---
date: 2022-06-23~~20:02:16
citation: OneNote-Лекция-№9
name: "Метод Рунге-Кутты 4-го Порядка"
---
# MOC:
- [[Метод Рунге-Кутты 4-го Порядка#Определение|Определение]];
- [[Метод Рунге-Кутты 4-го Порядка#Постановка задачи|Постановка задачи]];
- [[Метод Рунге-Кутты 4-го Порядка#Теория метода|Теория метода]];
- [[Метод Рунге-Кутты 4-го Порядка#Краткий алгоритм|Краткий алгоритм]].

## Определение:
**Метод Рунге-Кутты 4-го Порядка** — [[Численное Решения Задачи Коши ОДУ Первого Порядка#Методы численного решения задачи Коши ОДУ первого порядка|метод решения задачи коши]] [[ОДУ Первого Порядка|ОДУ первого порядка]].
Является [[Численное Решения Задачи Коши ОДУ Первого Порядка#Погрешности методов|методом 4-го порядка]].
Из лекции OneNote даны лишь формулы, остальное в других ресурсах.

## Постановка задачи:
### Исходные данные:
![[Численное Решения Задачи Коши ОДУ Первого Порядка#Постановка задачи]]
$w_h = \{x_i = x_0 + ih,i=0,...,N, N = \frac{x_N - x_0}{h}\}$ - [[Равномерная Сетка|равномерная сетка]].
В данном случае мы уже задали [[Шаг Сетки|шаг]] [[Равномерная Сетка]] $h$ и количество [[Узел Сетки|узлов]] [[Равномерная Сетка|равномерной сетки]] $N$.

### Результат метода:
Результатом **метода Эйлера** будет вектор [[Приближенное Решение|приближенных значений]] $u_h = \{u_0,u_1,...,u_N\}$.
Построенная на этих точках функция - [[Ломанная Эйлера|ломанная эйлера]].
![[Ломанная Эйлера#^7862c1]]

## Теория метода:
### Вывод формулы:
Из лекции OneNote даны лишь формулы:
Итерационная формула вычисления $u_{i+1}$ из $u_i$ имея [[Равномерная Сетка|равномерную сетку]] переменной $x$ с [[Шаг Сетки|шагом]] $h$:
$$u_{i+1} = u_i + \frac{1}{6}(K_1 + 2K_2 + 2K_3 + K_4)$$Где:
1) $K_1 = hf(x_i,u_i)$;
2) $K_2 = hf(x_i + \frac{h}{2}, u_i + \frac{K_1}{2})$;
3) $K_3 = hf(x_i + \frac{h}{2}, u_i + \frac{K_2}{2})$;
4) $K_4 = hf(x_i + h, u_i + K_3)$.
Промежуточные значения выше вычисляются перед вычислением каждого последующего приближенного значения $u_i$.

### Вывод погрешности:
Из лекции OneNote дана лишь конечная степень метода:
Метод Рунге-Кутты 4-го порядка - метод 4-го порядка $O(h^4)$ (при увеличении шага в $k$ раз погрешность увеличивается в $k^4$ раз).

### Как использовать допустимую числовую погрешность:
Если требуется решить задачу с определенной точностью $\epsilon$, то также используется вместе с **методом Эйлера** метод [[Метод Двойного Пересчёта|двойного пересчёта]].

## Краткий алгоритм:
### Краткая постановка задачи:
Необходимы решить [[Задача Коши|задачу коши]] [[ОДУ Первого Порядка|ОДУ первого порядка]] (найти [[Приближенное Решение|приближенное решение]] $u(x)$ для неизвестной [[Точное Решение|точной функции]] $\varphi(x)$) с [[Допустимая Числовая Погрешность|точностью]] $\epsilon$:
![[Численное Решения Задачи Коши ОДУ Первого Порядка#Задача Коши Задача коши]]

### Исходные данные:
- Формула $\varphi'(x) = u'(x) = f(x,\varphi(x))$;
- Граничное условие $\varphi(x_0) = u(x_0) = u_0$;
- Отрезок $[x_0;x_N]$;
- Изначальное количество [[Узел Сетки|узлов]] $N-1$ или [[Шаг Сетки|шаг]] $h$ [[Равномерная Сетка|равномерной сетки]] $w_h = \{x_i = x_0 + ih,i=0,...,N, N = \frac{x_N - x_0}{h}\}$.
- [[Допустимая Числовая Погрешность|Допустимая числовая погрешность]] $\epsilon$.

### Результат метода:
- Вектор [[Приближенное Решение|приближенного значения]] функции: $u = \{u_0,u_1,...,u_N\}$.

### Критерии использования метода:
Функция $\varphi(x)$ такая, что:
- $\varphi(x)$ - непрерывная;
- $\varphi(x)$ - непрерывно дифференцируема;

### Ход алгоритма:
1) Выбрали изначальный [[Шаг Сетки|шаг]] [[Равномерная Сетка|равномерной сетки]] $h$;
2) Вычислили весь вектор $u_h$ по формуле: $$u_{i+1} = u_i + \frac{1}{6}(K_1 + 2K_2 + 2K_3 + K_4)$$где (перед каждым последующим приближенным значением вычисляются промежуточные значения):
	1) $K_1 = hf(x_i,u_i)$;
	2) $K_2 = hf(x_i + \frac{h}{2}, u_i + \frac{K_1}{2})$;
	3) $K_3 = hf(x_i + \frac{h}{2}, u_i + \frac{K_2}{2})$;
	4) $K_4 = hf(x_i + h, u_i + K_3)$.
3) Уменьшили [[Шаг Сетки|шаг]] в два раза: $\frac{h}{2}$;
4) Вычислили весь вектор $u_{\frac{h}{2}}$ по формуле выше;
5) Сравниваем $u_h$ и $u_{\frac{h}{2}}$ по правилу: $max_{1\leq i \leq N}{|u_{hi} - u_{\frac{h}{2}2i}|}\leq \epsilon$$:
	1) Если неравенство выше ложно — переходим к шагу $(3)$.
	2) Иначе, вектор $u_{\frac{h}{2}}$ будет [[Приближенное Решение|приближенным решением]] с [[Допустимая Числовая Погрешность|точностью]] $\epsilon$.

### Погрешность метода:
**Метод Рунге-Кутты 4-го порядка** является  методом $4$-го порядка, из-за чего при уменьшении [[Шаг Сетки|шага]] [[Равномерная Сетка|равномерной сетки]] в $k$ раз погрешность уменьшится в $k^4$ раз.
