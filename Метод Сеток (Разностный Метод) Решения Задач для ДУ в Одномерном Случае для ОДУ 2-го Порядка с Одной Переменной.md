---
date: 2022-06-25~~14:24:00
citation: OneNote-Вычислительная_Математика-Лекция_№10
name: "Метод Сеток (Разностный Метод) Решения Задач для ДУ в Одномерном Случае для ОДУ 2-го Порядка" "Метод сеток (одномерный случай)" "Разностный метод (одномерный случай) ОДУ 2-го порядка" "Метод сеток ОС ОДУ 2-го порядка" "Разностный метод ОС ОДУ 2-го порядка"
---
# MOC:
- [[Метод Сеток (Разностный Метод) Решения Задач для ДУ в Одномерном Случае для ОДУ 2-го Порядка с Одной Переменной#Определение|Определение]];
- [[Метод Сеток (Разностный Метод) Решения Задач для ДУ в Одномерном Случае для ОДУ 2-го Порядка с Одной Переменной#Постановка задачи|Постановка задачи]];
- [[Метод Сеток (Разностный Метод) Решения Задач для ДУ в Одномерном Случае для ОДУ 2-го Порядка с Одной Переменной#Теория метода|Теория метода]];
- [[Метод Сеток (Разностный Метод) Решения Задач для ДУ в Одномерном Случае для ОДУ 2-го Порядка с Одной Переменной#Краткий алгоритм|Краткий алгоритм]].

## Определение:
[[Численное Дифференцирование#Методы решения задачи ОС|Метод]] решения задачи о [[Численное Дифференцирование|численном дифференцировании]] [[ОДУ 2-го Порядка|ОДУ 2-го порядка]] с одной переменной. При этом **метод сеток** можно использовать для всех видов краевых задач.
Метод основан на применении [[Разностные Аппроксимации Первой Производной|разностной аппроксимации для первой производной]] и [[Разностные Аппроксимации Второй Производной|разностной аппроксимации для второй производной]], в результате чего задача сводится к решению [[Системы Линейных Алгебраических Уравнений (СЛАУ)|СЛАУ]] любым доступным [[Методы Решения СЛАУ|методом]].

## Постановка задачи:
![[Численное Дифференцирование#Постановка задачи ОС]]

## Теория метода:
Из формулы выше: $$a(x)u''(x) + b(x)u'(x) + c(x)u(x) = F(x)$$ мы можем получить [[Системы Линейных Алгебраических Уравнений (СЛАУ)|СЛАУ]] подставив формулы разностной аппроксимации для [[Разностные Аппроксимации Первой Производной|первой]] и [[Разностные Аппроксимации Второй Производной|второй]] производных вместо соответствующих производных. Из чего мы получаем например уравнение вида: $$a(x_i)\frac{u(x_{i+1}) - 2u(x_i) + u(x_{i-1})}{h^2} + b(x_i)\frac{u(x_{i+1}) - u(x_{i-1})}{2h} + c(x_i)u(x_i) = F(x_i)$$ (для получения которого были использованы: [[Правый Разностный Аналог Второй Производной|правый разностный аналог для второй производной]] и [[Правый Разностный Аналог Первой Производной|правый разностный аналог для первой производной]]).
Погрешность такой замены выводится с помощью сравнения погрешностей всех использованных аналогов: самая плохая погрешность и будет являться погрешностью **метода сеток** (не учитывая погрешность при раскрытии производных краевых задач $2$ и $3$).
В данной ситуации погрешность обеих аналогов: $O(h^2)$, из-за чего погрешность данного метода тоже будет $O(h^2)$.

Совместив формулу выше и предоставленные граничные условия (из данного типа краевой задачи), мы получаем решаемую [[Системы Линейных Алгебраических Уравнений (СЛАУ)|СЛАУ]]: $$x\in[0;l]\rightarrow\Bigg\{\,\begin{array}{rcl}
	a(x_i)\frac{u(x_{i+1}) - 2u(x_i) + u(x_{i-1})}{h^2} + b(x_i)\frac{u(x_{i+1}) - u(x_{i-1})}{2h} + c(x_i)u(x_i) = F(x_i) \\
	Граничное\;условие\;№1 \\
	Граничное\;условие\;№2 \\
\end{array}$$
Более того (в данном случае), эта [[Системы Линейных Алгебраических Уравнений (СЛАУ)|СЛАУ]] описывает [[Матрица Якоби|трехдиагональную матрицу]], из-за чего дозволено применить [[Метод Прогонки|метод прогонки]] для его решения.
Однако можно применять любые доступные [[Методы Решения СЛАУ|методы]] для решения [[Системы Линейных Алгебраических Уравнений (СЛАУ)|СЛАУ]] выше.

Важно заметить, что в зависимости от примененного [[Методы Решения СЛАУ|метода]] решения [[Системы Линейных Алгебраических Уравнений (СЛАУ)|СЛАУ]], погрешность **метода сетки** может измениться в случае, если примененный метод имеет погрешность хуже, чем примененные аналоги производных.
Чтобы этого избежать, стоит применять [[Точные Методы Решения СЛАУ|точные методы решения СЛАУ]].

Также важно заметить, что в случае [[Вторая Краевая Задача ДУ|второй]] и [[Третья Краевая Задача ДУ|третьей]] краевых задач, погрешность примененного [[Разностные Аппроксимации Первой Производной|разностного аналога]] для получения значения функции из производной также влияет на погрешность **метода сеток**.

```ad-note
Информация дальше не была предоставлена во время лекции, но я считаю, что эти суждения правдивы.
```

После решения [[Системы Линейных Алгебраических Уравнений (СЛАУ)|СЛАУ]], для достижения необходимой [[Допустимая Числовая Погрешность|точности]] $\epsilon$ шаг $h$ [[Равномерная Сетка|равномерной сетки]] уменьшается в $2$ раза, после чего [[Приближенное Решение|приближенное решение]] [[Системы Линейных Алгебраических Уравнений (СЛАУ)|СЛАУ]] вычисляется снова. После чего результат сравнивается с предыдущим с помощью [[Допустимая Числовая Погрешность|точности]] $\epsilon$.
Повторяя этот процесс с помощью [[Метод Двойного Пересчёта|метода двойного пересчёта]] мы получаем [[Приближенное Решение|приближенное решение]] с [[Допустимая Числовая Погрешность|точностью]] $\epsilon$.

## Краткий алгоритм:
### Краткая постановка задачи:
Необходимо найти вектор [[Приближенное Решение|приближенных значений]] $u(x)$ [[Точное Решение|точной функции]] $\varphi(x)$ для [[ОДУ 2-го Порядка|ОДУ 2-го порядка]] с одной переменной с [[Допустимая Числовая Погрешность|точностью]] $\epsilon$ (определенная краевая задача [[ОДУ 2-го Порядка|ОДУ 2-го порядка]]с одной переменной): ![[Численное Дифференцирование#Постановка задачи ОС]]

### Искомые данные:
- Формула $a(x)u''(x)+b(x)u'(x) + c(x)u(x) = F(x)$;
- Граничные условия:
	- $u(0) = A$ и $u(l) = B$ - для [[Первая Краевая Задача ДУ|первой краевой задачи ДУ]];
	- $u'(0) = A$ и $u'(l) = B$ - для [[Вторая Краевая Задача ДУ|второй краевой задачи ДУ]];
	- $u(0)u'(0) = A$ и $u(l)u'(l) = B$ - для [[Третья Краевая Задача ДУ|третьей краевой задачи ДУ]].
- Отрезок $x\in[0,l]$;
- Изначальное количество [[Узел Сетки|узлов]] $N+1$ или [[Шаг Сетки|шаг]] $h$ [[Равномерная Сетка|равномерной сетки]] $w_h = \{x_i = x_0 + ih, i=0,...,N, N = \frac{l - 0}{h}\}$.
- [[Допустимая Числовая Погрешность|Допустимая числовая погрешность]] $\epsilon$.

### Неизвестные:
- [[Точное Решение|Точная]] функция $\varphi(x)$.

### Результат метода:
- Вектор [[Приближенное Решение|приближенного значения]] функции: $u = \{u_0,u_1,...,u_N\}$.

### Критерии использования метода:
Функция $\varphi(x)$ такая, что:
- $\varphi(x)$ - непрерывная;
- $\varphi(x)$ - непрерывно дифференцируема.

### Ход алгоритма:
Шаги $4$ и $6$ необязательны для вычисления результата, они нужны только если мы разрабатываем новый метод.
1) Выбрали изначальный шаг равномерной сетки $h$;
2) Выбрали способ приближенного вычисления производных с помощью [[Разностные Аппроксимации Первой Производной|разностных аппроксимаций для первых]] и [[Разностные Аппроксимации Второй Производной|вторых]] производных;
	1) Для примера получили раскрытие формулы в виде: $$a(x_i)\frac{u(x_{i+1}) - 2u(x_i) + u(x_{i-1})}{h^2} + b(x_i)\frac{u(x_{i+1}) - u(x_{i-1})}{2h} + c(x_i)u(x_i) = F(x_i)$$ используя [[Правый Разностный Аналог Второй Производной|правый разностный аналог для второй производной]] и [[Правый Разностный Аналог Первой Производной|правый разностный аналог для первой производной]].
3) Если дана [[Вторая Краевая Задача ДУ|вторая]] либо [[Третья Краевая Задача ДУ|третья]] краевая задача, то приблизительно вычисляем значение функции из соответствующих производных, и запоминаем погрешность применяемого [[Разностные Аппроксимации Первой Производной|аналога]];
4) Вычисляем погрешность **метода сеток** (либо если уже известно запоминаем его), при этом учитывая погрешность [[Приближенное Решение|приближенного]] преобразования граничных условий:
	1) Для примера выше погрешность преобразования искомой функции будет $O(h^2)$ не учитывая используемые аналоги для раскрытия граничных условий;
	2) Для произвольной формулы выбираем самую плохую погрешность из применимых разностных аналогов для функции и граничных условий.
5) Используя раскрытую выше формулу и граничные условия, применяем [[Методы Решения СЛАУ|методы]] решения [[Системы Линейных Алгебраических Уравнений (СЛАУ)|СЛАУ]] и получаем вектор приближенного решения $u_h$:
	1) Для примера выше и других [[Системы Линейных Алгебраических Уравнений (СЛАУ)|СЛАУ]], описывающих [[Матрица Якоби|матрицу Якоби (трёхдиагональная матрица)]], стоит применять [[Метод Прогонки|метод прогонки]] либо любой применимый [[Точные Методы Решения СЛАУ|точный метод решения]];
	2) Для произвольного примера применяем любой доступный метод.
6) Учитываем погрешность используемого на шаге $(5)$ метода, чтобы вычислить общую погрешность **метода сеток**;
7) Уменьшаем [[Шаг Сетки|шаг]] [[Равномерная Сетка|равномерной сетки]] $h$ в $2$ раза;
8) Используя раскрытую выше формулу и граничные условия, применяем [[Методы Решения СЛАУ|методы]] решения [[Системы Линейных Алгебраических Уравнений (СЛАУ)|СЛАУ]] и получаем вектор [[Приближенное Решение|приближенного решения]] $u_\frac{h}{2}$;
9) Сравниваем $u_h$ и $u_{\frac{h}{2}}$ по правилу $max_{1\leq i \leq N}{|u_{hi} - u_{\frac{h}{2}2i}|}\leq \epsilon$:
	1) Если неравенство выше ложно: $u_h = u_{\frac{h}{2}}$ и переходим к шагу $(7)$;
	2) Иначе, вектор $u_{\frac{h}{2}}$ и будет [[Приближенное Решение|приближенным решением]] с [[Допустимая Числовая Погрешность|точностью]] $\epsilon$.