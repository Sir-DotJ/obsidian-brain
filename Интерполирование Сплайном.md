---
date: 2022-05-09~~16:43:06
citation: Практика№7_Onenote
name: "Интерполирование Сплайном"
---
Метод [[Приближение Функции|приближения функции]] если мы понимаем $f(x) \approx f^*(x)$ как функция проходит "[[Приближение Функции#^212338|через]]" заданные точки.
Схож с [[Метод Интерполяции|методом интерполяции]], однако при том методы мы находили [[Полином n-й Степени|полином n-й степени]], что даёт хороший результат внутри границ сетки, но за пределами её изменяется очень быстро.
В этом методе мы находим [[Функция Сплайн|функцию сплайн]] заданного [[Порядок Сплайна|порядка]] и [[Дефект Сплайна|дефекта]].

## Постановка задачи:
Дана таблица координат $(x_i, y_i),\;\; i=1,...,N$, полученная эмпирическим путем (или просто дана).
Нам требуется найти приближенную функцию $f^*(x) \approx f(x_i) = y_i$ такую, что:
1) Любая произвольная $x_i,\;\;i=1,...,N$ при подстановке в формулы $f^*(x)$ и $f(x)$ даёт тождество $f^*(x_i) = f(x_i)$;
2) Однако таких функция может быть бесконечное количество, поэтому мы ограничиваемся условием, что функция $f^*(x)$ - является [[Функция Сплайн|сплайном]] заданного [[Порядок Сплайна|порядка]] и [[Дефект Сплайна|дефекта]].

## Теория метода:
Построим интерполяционный [[Функция Сплайн|сплайн]] $3$-го ($S$) [[Порядок Сплайна|порядка]] с [[Дефект Сплайна|дефектом]] $1$ ($d$) (из-за чего полиномы будут непрерывно дифференцироваться $3 - 1 = 2$ раза ($k$)):

### Искомые данные:
Набор координат $(x_i,y_i),i=0,...,N$
Построим такую функцию $F(x) = f^*(x)$:
1) $F(x_i) = y_i, i=0,...,N$;
2) На отрезке $[x_i;x_{i+1}]$ функция — [[Полином n-й Степени|полином]] степени 3 $P^{i+1}_3$;
3) Функция $F(x)$ непрерывная и дважды непрерывно дифференцируема, условия склейки:
	3.1) $P^i_3(x_i) = P^{i+1}_3(x_i)$;
	3.2) $(P^i_3 (x_i))' = (P^{i+1}_3(x_i))'$;
	3.3) $(P^i_3 (x_i))'' = (P^{i+1}_3(x_i))''$.
![[Pasted image 20220509181850.png]]

### Вывод формулы:
Формула для $i$-го [[Полином n-й Степени|полинома]] 3й степени:
$P^i_3(x) = a_0^i + a_1^ix + a_2^ix^2 + a^i_3x^3$.
Запишем в более удобном виде:

$P^i_3(x) = a_i + b_i(x-x_{i-1}) + c_i(x - x_{i-1})^2 + d_i(x - x_{i-1})^3\;\;\;(1)$
%%^вывод_формула_1%%

$x_i - x_{i-1} = h_i$ - замена на будущее.

**Задача**: найти все неизвестные $a_i, b_i, c_i, d_i,\;\; i=1,...,N$, всего выходит $4N$ неизвестных. Для каждого нужна формула.

Из условия $F(x_i) = y_i, i=0,...,N$ следует:
$P^i_3(x_i) = y_i$, $P^{i-1}_3(x_{i-1}) = y_{i-1}$. Из чего следует:
$a_i = y_{i-1},\;\; i=1,...,N-1$. Получили $N$ уравнений.

Используя замену $x_i - x_{i-1} = h_i$ и вывод из условия $1$: $P_3^N(x_N) = y_N \rightarrow a_N + b_N(x_N - x_{N-1}) + c_N(x_N - x_{N-1})^2 + d_N(x_N - x_{N-1})^3$, получаем формулу:
$$\begin{array}{ctl}
a_N + b_Nh_N + c_Nh^2_N + d_Nh^3_N = y_N\\
a_i=y_{i-1},i=1,...,N-1\\
\end{array}\Big{\}}\;\;\;(2)$$ %%^вывод_формула_2%% ^6c8a3b

Таким образом мы имеем $(N+1)$ уравнений: для всех $a_i, i=1,...,N$.

Далее из условия $P^i_3(x_i) = P^{i+1}_3(x_i)$: $a_i + b_i(x-x_{i-1}) + c_i(x - x_{i-1})^2 + d_i(x-x_{i-1})^3 = a_{i+1} + b_{i+1}(x-x_i) + c_{i+1}(x-x_i)^2 + d_{i+1}(x-x_i)^3$
Отсюда получаем следующий набор формул:

$$a_i + b_ih_i + c_ih_i^2 + d_ih_i^3 = a_{i+1},\;\;i=1,...,N-1\;\;\;(3)$$
%%^вывод_формула_3%%

$a_{i+1},a_i$ мы уже все узнали так что мы получили $(N-1)$ новых формул.

Пока что мы имеем $2N$ формул.

Аналогично из условия $(P^i_3 (x_i))' = (P^{i+1}_3(x_i))'$:
$b_{i} + 2c_i(x_i-x_{i-1}) + 3d_i(x_i-x_{i-1})^2 = b_{i+1} + 2c_{i+1}(x_i-x_i) + 3d_{i+1}(x_i-x_i)^2$
$x_i - x_i = 0$ поэтому в итоге выходит следующий набор формул:

$$b_i + 2c_ih_i + 3d_ih_i^2 = b_{i+1},\;\;i=1,...,N-1,\;\;(4)$$
%%^вывод_формула_4%%

Еще $(N-1)$ новых формул.

Аналогично из условия $(P^i_3 (x_i))'' = (P^{i+1}_3(x_i))''$:
$c_i + 3d_ih_i = c_{i+1},\;\;i=1,...,N-1\;\;(5)$
%%^вывод_формула_5%%

Ещё $(N-1)$ новых формул.

В сумме из формул $(2),(3),(4),(5)$ выходит $4N-2$ уравнений.
Остальные два уравнения нужно получить из $x_0$ и $x_N$.
Как именно это сделать зависит полностью от вас, можно любое условие поставить.
Но для общего использования скажем, что вторые производные в этих точках равны $0$:

$(P^1_3(x_0))'' = 0 \rightarrow 2c_1 + 6d_1(x_0 - x_0) = 0$
Из чего следует:

$$c_1 = 0\;\;(6)$$
%%^вывод_формула_6%%

Аналогично:
$(P_3^N(x_N))'' = 0 \rightarrow 2c_N + 6d_N(x_N - x_{N-1}) = 0$
Из чего следует:

$$c_N+3d_Nh_N = 0\;\;(7)$$

Таким образом мы получили $4N$ уравнений.
Из них можно составить [[Системы Линейных Алгебраических Уравнений (СЛАУ)|СЛАУ]]:
Неизвестные $a_i,b_i,c_i,d_i,\;\;i=1,...,N$
Можно записать в виде [[Матрица Квайна|трехдиагональной матрицы]], из-за чего эта [[Системы Линейных Алгебраических Уравнений (СЛАУ)|СЛАУ]] решается легко с помощью [[Метод Прогонки|метода прогонки]].
Переведем в [[Матрица Квайна|трехдиагональную матрицу]]:
Из уравнения $(2)$:
$$\begin{array}{ctl}
a_N + b_Nh_N + c_Nh^2_N + d_Nh^3_N = y_N\\
a_i=y_{i-1},i=1,...,N-1\\
\end{array}\Big{\}}\;\;\;(2)$$
Мы знаем все $a_i$

Из уравнения $(3)$:
$$a_i + b_ih_i + c_ih_i^2 + d_ih_i^3 = a_{i+1},\;\;i=1,...,N-1\;\;\;(3)$$
Выразим $b_i$. Пусть [[Сетка|сетка]] - [[Равномерная Сетка|равномерная]].
$b_ih + c_ih^2 + d_ih^3 = y_i-y_{i-1}$
$b_i = \frac{y_i - y_{i-1}}{h} - c_ih - d_ih^2$
Аналогично для $b_{i+1}$:
$b_{i+1} = \frac{y_{i+1}-y_i}{h} - c_{i+1}h - d_{i+1}h^2$
Тогда:
$$b_{i+1} - b_i = \frac{y_{i+1}-y_{y-1}}{h} - h(c_{i+1}-c_i) - h^2(d_{i+1}-d_i)\;\;(8)$$
Подставив уравнение выше в уравнение $(4)$:
$$b_i + 2c_ih_i + 3d_ih_i^2 = b_{i+1},\;\;i=1,...,N-1,\;\;(4)$$
Получим:
$$2c_ih + 3d_ih^2 = \frac{y_{i+1}-y_{y-1}}{h} - h(c_{i+1}-c_i) - h^2(d_{i+1}-d_i)\;\;(9)$$

Если теперь выразить из уравнения $(5)$:
$$c_i + 3d_ih_i = c_{i+1},\;\;i=1,...,N-1\;\;(5)$$
$d_i$, мы получим уравнение:
$d_i = \frac{1}{3h}(c_{i+1} - c_i)$
Аналогично для $d_{i+1}$
$d_{i+1} = \frac{1}{3h}(c_{i+2} - c_{i+1})$

Тогда:
$$d_{i+1} - d_i = \frac{1}{3h}(c_{i+2} - c_i)\;\;(10)$$

Подставив это и уравнение $(5)$ уравнение в уравнение $(9)$:
$$2c_ih + 3d_ih^2 = \frac{y_{i+1}-y_{y-1}}{h} - h(c_{i+1}-c_i) - h^2(d_{i+1}-d_i)\;\;(9)$$

Мы получаем важное уравнение:
$$2c_ih + h(c_{i+1} - c_i) = \frac{y_{i+1} - y_{i-1}}{h} - h(c_{i+1}-c_i) - h^2\frac{1}{3h}(c_{i+2} - c_i)\;\;\;(11)$$
В этом уравнении одна переменная $c_i$, при этом мы получили уравнение из трех его индексов $(i, i+1, i+2)$.
Теперь мы получили [[Матрица Квайна|трехдиагональную матрицу]] неизвестных, которую легко решить [[Метод Прогонки|методом прогонки]] (из раннее заданных условий: $c_1 = 0$, $c_N = 0$).

После решения этой матрицы методом прогонки мы можем по ранее найденной формуле $d_i = \frac{1}{3h}(c_{i+1} - c_i)$ вычислить все $d_i$.
Также по раннее найденной формуле $b_i = \frac{y_i - y_{i-1}}{h} - c_ih - d_ih^2$ мы можем вычислить все $b_i$.

После чего мы можем вычислить последнюю $a_N$ из $(2)$.

По итогу, мы вычислили:
- Все $a_i$ (по формуле $2$);
- Все $b_i$;
- Все $c_i$;
- Все $d_i$.
Задача решена, осталось только их подставить в формулу $1$:
$P^i_3(x) = a_i + b_i(x-x_{i-1}) + c_i(x - x_{i-1})^2 + d_i(x - x_{i-1})^3\;\;\;(1)$
И мы получили нужный нам сплайн.