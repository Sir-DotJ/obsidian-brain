---
date: 2022-05-29~~16:26:38
citation: OneNote/Лекция№8:Численное Интегрирование
name: "Метод Симпсона"
---
## Определение:
Является одним из [[Численное Интегрирование#Методы численного интегрирования|методов]] [[Численное Интегрирование|численного интегрирования]]. Основан на разбиении интеграла на наборы [[Полином n-й Степени|полиномов]] второй степени, проходящие через три координаты промежутка, и которые склеены между собой (чем то похоже на [[Интерполирование Сплайном|интерполирование сплайном]]). На графе это выглядит так:
![[Pasted image 20220529164309.png]]
%%^краткое_определение%%

## Теория метода:
### Вывод формулы приближенного $\overline{I}$:
Для заданного определенного интеграла $\int^b_a{f(x)dx} = I$ используя заданную функцию (или набор координат) разделим отрезок $[a,b]$ на $N$ частей:
- Либо можно разделить отрезок используя шаг $x_i - x_{i-1} = h$ для [[Равномерная Сетка|равномерной]] [[Сетка|сетки]];
- Либо $x_i - x_{i-1} = h_i$ для [[Неравномерная Сетка|неравномерной]] [[Сетка|сетки]].
Из чего мы получаем [[Сетка|сетку]] для $x$:
- Либо [[Равномерная Сетка|равномерную]] $w_h = \{x_i = a + ih, i=0,...,N, h = \frac{b-a}{N}\}$.
- Либо [[Неравномерная Сетка|неравномерную]] $w = \{x_i, i=0,...,N, h_i = x_i - x_{i-1}\}$;
В любом случае **количество полученных координат будет равно**: $N + 1$.
Однако намного удобнее работать с [[Равномерная Сетка|равномерной]] [[Сетка|сеткой]], поэтому далее будут проходить рассуждения для них.
На графе это разделение выглядит так:
![[Pasted image 20220529164309.png]]
Мы знаем из условия значения трех координат, через которые соответственно проходят [[Полином n-й Степени|полиномы]] 2‑й степени.
Из чего, используя [[Полином Лагранжа|полином Лагранжа]], мы можем вывести формулу интеграла отрезка $[x_0,x_2]$ например:
$\overline{I}_1 = \frac{h}{3}[y_0 + 4y_1 + y_2]$.
Аналогично мы можем найти значение интеграла [[Полином n-й Степени|полинома]] 2‑й степени на отрезке $[x_2,x_4]$: $\overline{I}_2 = \frac{h}{3}[y_2 + 4y_3 + y_4]$.
Мы можем вывести таки образом формулу для последнего интеграла [[Полином n-й Степени|полинома]] 2-й степени: $\overline{I}_{N-2} = \frac{h}{3}[y_{N-2} + 4y_{N-1} + y_N]$.
И тогда сумма всех этих интегралов и будет нашим приближенным значением определенного интеграла $I \approx \overline{I}$.
Формула для произвольного количества точек $N$:
$$\overline{I} = \frac{h}{3}[y_0 + 4\sum^{\frac{N}{2}}_{i=1}{y_{2i-1}} + 2\sum^{\frac{N}{2}-1}_{i=1}{y_{2i}} + y_N]$$
Из чего также вытекает критерий использования метода Симпсона: $N$ - четное число.
([[Вывод Формулы интеграла для метода Симпсона|полный вывод формул интегралов здесь]])

### Вычисление до точности $\epsilon$:
Однако по задаче о числовом интегрировании необходимо вычислить интеграл с [[Допустимая Числовая Погрешность|точностью]] $\epsilon$.
Для этого применяется [[Метод Двойного Пересчёта|метод двойного пересчета]]:
![[Метод Двойного Пересчёта]]
Для метода срединных прямоугольников можно показать, что [[Погрешность Численного Интегрирования|погрешность метода]]: $R(h) = C_5\cdot h^4,\;\; C_5>0$. Из-за чего **симпсона является [[Численное Интегрирование#Методы численного интегрирования|методом]] 4-го [[Порядок Метода Численного Интегрирования|порядка]]**.
Из чего мы можем вывести окончательный алгоритм метода.

## Алгоритм метода:
### Искомая информация:
- Функция $f(x)$, определенный интеграл которого мы хотим найти;
- $[a,b]$ - границы определенного интеграла;
- $\epsilon$ - [[Допустимая Числовая Погрешность|точность]], с которой мы хотим найти определенный интеграл.

### Критерий использования:
- Если изначальный [[Шаг Сетки|шаг]] [[Равномерная Сетка|равномерной]] [[Сетка|сетки]] $h$ задан до начала алгоритма, то [[Шаг Сетки|шаг]] должен быть таким, что по формуле $\frac{b - a}{h} = N$: $N$ - четное число.

### Ход алгоритма:
1) Задали произвольный [[Шаг Сетки|шаг]] [[Равномерная Сетка|равномерной]] [[Сетка|сетки]] $h$ для отрезка $[a,b]$ ([[Шаг Сетки|шаг]] задан таким образом, что по формуле $\frac{b - a}{h} = N$: $N$ - Четное число);
2) Вычислили приближенное значение интеграла $\overline{I}_h$ по формуле: $\overline{I}_h = \frac{h}{3}[y_0 + 4\sum^{\frac{N}{2}}_{i=1}{y_{2i-1}} + 2\sum^{\frac{N}{2}-1}_{i=1}{y_{2i}} + y_N]$;
3) Поделили [[Шаг Сетки|шаг]] на два: $h = \frac{h}{2}$;
4) Вычислили приближенное значение интеграла $\overline{I}_{\frac{h}{2}}$ по формуле: $\overline{I}_{\frac{h}{2}} = \frac{h}{3}[y_0 + 4\sum^{\frac{N}{2}}_{i=1}{y_{2i-1}} + 2\sum^{\frac{N}{2}-1}_{i=1}{y_{2i}} + y_N]$;
5) Сравниваем оба приближенных решения между собой:
	1) Если $|\overline{I}_h - \overline{I}_{\frac{h}{2}}| \leq \epsilon$, то приближенным решением $\overline{I} \approx I$ с [[Допустимая Числовая Погрешность|точностью]] $\epsilon$ будет являться $\overline{I}_{\frac{h}{2}}$;
	2) Иначе $\overline{I}_h = \overline{I}_{\frac{h}{2}}$ и переходим к шагу $(3)$.
	(Cуществует более полная формула: $\frac{|\overline{I}_h - \overline{I}_{\frac{h}{2}}|}{2^p - 1} \leq \epsilon$, которая также использует [[Порядок Метода Численного Интегрирования|порядки]] [[Численное Интегрирование#Методы численного интегрирования|методов]] [[Численное Интегрирование|численного интегрирования]] $p = 4$, однако при маленькой [[Допустимая Числовая Погрешность|точности]] $\epsilon$ о нём можно не думать)